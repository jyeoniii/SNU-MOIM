<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<button *ngIf="currentUser" (click)="signOut()" class="btn btn-primary btn-primary" style="float:right;">SignOut</button>

<h2 class="text-center">Meeting Detail</h2><br>

 <div class="container center-block" style="width:600px;">

   <h3>Meeting</h3>
   <span *ngIf="selectedMeeting && !selectedMeeting.is_closed; else closed">
     <span *ngIf="isOwner(); else notOwner">
      <button (click)="closeMeeting()" style="float:right" class="btn btn-primary btn-primary">CLOSE</button>
     </span>
     <ng-template #notOwner>
       <span *ngIf="alreadyJoined; else canJoin">
         <button *ngIf="currentUser && selectedMeeting" (click)="leaveMeeting()" style="float:right" class="btn btn-primary btn-primary">
           LEAVE
         </button>
       </span>
       <ng-template #canJoin>
         <button *ngIf="currentUser && selectedMeeting" (click)="joinMeeting()" style="float:right" class="btn btn-primary btn-primary">
         JOIN
         </button>
       </ng-template>
     </ng-template>
   </span>
   <ng-template #closed>
     <button class="btn" style="float:right; color: maroon" disabled>CLOSED</button>
   </ng-template>



   <div *ngIf="selectedMeeting">
     <span style="font-weight: bold">title: </span> {{ selectedMeeting.title }}<br>
     <span style="font-weight: bold">author: </span> {{ selectedMeeting.author.name }}<br>
     <span style="font-weight: bold">location:</span> {{ selectedMeeting.location }}<br>
     <span style="font-weight: bold">participation: </span>
       <i *ngFor="let m of selectedMeeting.members" class="fa fa-user" style="font-size:25px; color: royalblue"></i>
       <i *ngFor="let m of emptySeats" class="fa fa-user" style="font-size:25px; color: darkgray "></i><br>

     <span style="font-weight: bold">description: <br></span>{{ selectedMeeting.description }}<br>
   </div>
   <br>
   <!--Comments-->
   <h3>Comments</h3>
   <div *ngIf="comments">
     <!--Create comment-->
     <input [(ngModel)]="newComment" style="width:400px;">
     <button (click)="createComment(newComment)" class="btn btn-primary btn-sm" id="create-comment-button">CREATE</button>
     <input type="checkbox" class="checkbox-inline" [checked]="isPrivate" (click)="changePrivateMode(true)"> Private
     <li *ngFor="let comment of comments">
       <span *ngIf="comment.publicity || currentUser.id===selectedMeeting.author.id || currentUser.id===comment.author.id; else private_comment">
         <!--Author of the comment-->
         <span style="font-weight:bold">{{ comment.author.name }}</span>
         <!--Content of the comment-->
         :
         <span *ngIf="selectedComment!==comment;else edit_mode">
            {{comment.content}}
             <!--Edit / Delete button-->
            <span *ngIf="currentUser && (currentUser.id===comment.author.id)">
              <button (click)="toEditMode(comment)" class="btn btn-primary btn-sm" style="margin-left:20px;" id="edit-comment-button">EDIT</button>
              <button (click)="deleteComment(comment)" class="btn btn-primary btn-sm" id="delete-comment-button">DELETE</button>
            </span>
          </span>

         <ng-template #edit_mode>
           <input [(ngModel)]="comment.content">
           <button (click)="editComment(comment)" class="btn btn-primary btn-sm" id="update-button">UPDATE</button>
           <button (click)="cancleEditMode(comment)" class="btn btn-primary btn-sm" id="cancle-edit-button">CANCLE</button>
           <input type="checkbox" class="checkbox-inline" [checked]="!comment.publicity" (click)="changePrivateMode(false)"> Private
         </ng-template>
       </span>

       <ng-template #private_comment>
         <label style="color:royalblue">Private comment</label>
       </ng-template>
     </li>
   </div><br>

   <span *ngIf="isOwner() && selectedMeeting && !selectedMeeting.is_closed">
    <button (click)="edit()" class="btn btn-primary btn-primary" id="edit-button" >EDIT</button>
    <button (click)="delete()" class="btn btn-primary btn-primary" id="delete-button">DELETE</button>
  </span>
   <button (click)="goBack()" class="btn btn-primary btn-primary" id="back-button">BACK</button>

 </div>
